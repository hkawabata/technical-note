---
title: 区間推定
title-en: Interval Estimation
---

# 区間推定とは

- 母集団の真の統計量（母数）$a$
- 母集団から標本を取り出して計算した推定量 $\hat{a}$

の間には誤差が生じる。  
[点推定](point-estimation.md)では母集団のただ一つの推定値を求めたのに対して、**区間推定** では「標本から推定すると、95%の確率で母数がこの範囲に収まるはず」というような値の範囲（**信頼区間**）を求める。  
この例で言う「95%」を **信頼度** と呼び、他にも問題設定に応じて 99% 信頼区間や 99.9% 信頼区間を求めることがある。

# 区間推定の理論

## 母平均の区間推定（母分散：未知 / 標本数：大）

### 問題設定

一般に、「母集団の平均は分からないが分散だけは分かっている」ということは現実世界では考えにくい。

そのため、ここでは

- 母分散 $\sigma^2$ が分からない
- 標本数 $n$ が十分に大きい

という条件を仮定し、母平均 $\mu$ について、信頼度 $c$ の信頼区間を推定する。

### 区間推定の流れ

標本数 $n$ が十分に大きい場合、[中心極限定理](../central-limit-theorem.md)により、標本平均 $\bar{x}$ は平均 $\mu$、分散 $\sigma^2/n$ の正規分布 $N \left( \mu, \sigma^2/n \right)$ に従うと考えて良い。

$$
\bar{x} \sim N \left( \mu, \sigma^2/n \right)
$$

$\bar{x}$ を標準化した確率変数 $z$ は標準正規分布 $N(0, 1)$ に従う。

$$
z := \cfrac{\bar{x}-\mu}{\sigma/\sqrt{n}} \sim N(0, 1)
$$

母分散 $\sigma^2$ は未知であるが、$n$ が十分大きい場合は不偏分散

$$
s^2 = \cfrac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2
$$

で近似できるので、

$$
z = \cfrac{\bar{x}-\mu}{s/\sqrt{n}} \sim N(0, 1)
$$

信頼度 $c$ の信頼区間を求めるには、標準正規分布の面積（= 確率）のうち割合 $c$ を占める範囲内に $z$ があれば良い。  
すなわち、下のグラフで「赤色部分の面積 $= c$」となれば良い。  
正規分布は左右対称なので、「グラフ右側の灰色部分の面積 $= (1-c)/2$」と言い換えることもできる。

![Figure_1](https://user-images.githubusercontent.com/13412823/217245856-1fd4a159-b5eb-41ba-babf-39d187f384cb.png)

「標準正規分布に従う確率変数 $z$ が $a \le z$ の範囲に入る確率」は、**標準正規分布表** としてまとめられ広く知られている。  
上のグラフで言うと、「グラフ右側の灰色部分の面積」と「それを与える $a$ の値」の対応表が標準正規分布表。

この対応表を用いて「赤色部分の面積 $= c$」となるような $a=a_c$ を求めると、$z$ が満たすべき不等式は

$$
\begin{eqnarray}
	& -a_c \le z \le a_c
	\\ \Longleftrightarrow &
	-a_c \le \cfrac{\bar{x}-\mu}{s/\sqrt{n}} \le a_c
	\\ \Longleftrightarrow &
	\bar{x}-\cfrac{s}{\sqrt{n}}a_c \le \mu \le \bar{x}+\cfrac{s}{\sqrt{n}}a_c \qquad (1)
\end{eqnarray}
$$

これが $\mu$ の信頼区間となる。  


### 具体例

- A 県の16歳男子の健康診断データから1000人分の身長を標本として抽出
- 標本の平均 $\bar{x} = 162.0\ \mathrm{cm}$、不偏分散 $s^2 = 5.8^2$

このとき、A 県の16歳男子の平均身長 $\mu$（母平均）の信頼区間を信頼度 95% で推定する。

$n=1000$ が十分大きいので、$\bar{x}$ は正規分布に従うと考えて良い。  
また、信頼度 95%（$c=0.95$）となるような $a$ の値は、標準正規分布表より$a_c = 1.96$

したがって、$(1)$ 式に既知の数値を代入して、

$$
162.0 - \cfrac{5.8}{\sqrt{1000}} \times 1.96
\le \mu \le
162.0 + \cfrac{5.8}{\sqrt{1000}} \times 1.96
$$

左辺・右辺を計算すれば、

$$
161.64 \le \mu \le 162.36
$$

これが求める信頼区間となる。


## 母平均の区間推定（母分散：未知 / 標本数：小）

### 問題設定

前節と同じく母集団の分散が不明であり、多数の標本を取ることも困難であるような状況を考える。  
ex. 1台あたりが高価な家電製品の不良品率を調べるためのサンプリング

このような場合であっても、**母集団が正規分布に従う** と仮定できるのであれば、母平均 $\mu$ に関して信頼度 $c$ の信頼区間を推定できる。

- 母分散 $\sigma^2$ が分からない
- 標本数 $n$ が小さい
- 母集団は正規分布に従う

### 区間推定の流れ

標本数 $n$ が小さいので、中心極限定理は適用できない。  
しかし、母集団が正規分布に従うとしているので、以下の統計量 $t$ は自由度 $n-1$ の t 分布 $t(n-1)$ に従う。

$$
t := \cfrac{\bar{x}-\mu}{\sqrt{s^2/n}} \sim t(n-1)
$$

ただし、$\bar{x}$ は標本平均、$s^2$ は不偏分散を表す。

t 分布は正規分布のように、$t=0$ を中心とする左右対称の釣り鐘型をしている。  
よって、前節と同様に「$-t_c \le t \le t_c$の範囲内の確率密度関数の面積 $= c$」となるような $t_c$ を求めれば良い。

標準正規分布表と同じく t 分布についても、「確率密度関数の $t_c \le t$ 部分の面積」と「それを与える $t_c$ の値」をまとめた **t 分布表** が広く知られている。  
それを参照して $t_c$ を求めると、$t$ が満たすべき不等式は

$$
\begin{eqnarray}
	& -t_c \le t \le t_c
	\\ \Longleftrightarrow &
	-t_c \le \cfrac{\bar{x}-\mu}{s/\sqrt{n}} \le t_c
	\\ \Longleftrightarrow &
	\bar{x}-\cfrac{s}{\sqrt{n}}t_c \le \mu \le \bar{x}+\cfrac{s}{\sqrt{n}}t_c \qquad (2)
\end{eqnarray}
$$

これが $\mu$ の信頼区間となる。

### 具体例

- ある工場で生産している部品 A をランダムに10個抽出し、質量を測定
- 標本平均 $\bar{x} = 100.03\ \mathrm{g}$、不偏分散 $s^2 = 2.22$

このとき、部品 A の平均質量 $\mu$（母平均）の信頼区間を信頼度 95% で推定する。

部品の質量分布として正規分布を仮定すると、標本数 $n=10$ なので、

$$
t = \cfrac{\bar{x}-\mu}{\sqrt{s^2/n}}
$$

は自由度 $n-1=9$ の t 分布に従う。  
t 分布表より、自由度9で信頼度 95% となるような $t_c$ の値は $t_c = 2.262$

したがって、$(2)$ 式に既知の数値を代入して、

$$
100.03 - \sqrt{\cfrac{2.22}{10}} \times 2.262
\le \mu \le
100.03 + \sqrt{\cfrac{2.22}{10}} \times 2.262
$$

左辺・右辺を計算すれば、

$$
98.96 \le \mu \le 101.10
$$

これが求める信頼区間となる。