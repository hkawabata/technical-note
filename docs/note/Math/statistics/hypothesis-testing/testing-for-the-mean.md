---
title: 母平均の検定
title-en: Hypothesis Testing for the Mean
---

# 両側 t 検定

> **【問題設定】**
> 
> - 前提
> 	- 母集団が **正規分布** に従う
> - 調べたいこと
> 	- 注目する統計量がある値と一致するか否か？

## 理論

母集団が母平均 $\mu$ の正規分布に従うと仮定した時、この母集団から $n$ 件の標本を抽出した標本平均を $\bar{x}$、不偏分散を $s^2$ とすると、統計量

$$
t := \cfrac{\bar{x}-\mu}{\sqrt{s^2/n}}
$$

は自由度 $n-1$ の t 分布に従う。  
この $t$ を用いた仮説検定の手法を **t 検定** と呼ぶ。

> **【NOTE】** 自然界の多くの分布は正規分布に従うため、母集団が正規分布に従うと仮定することが多い。そのため、t 検定は非常に頻繁に使用される。

## 具体例

ある工場では、寸法が $10.00\ [\mathrm{cm}]$ になるよう設計された部品 A を製造している。  
実際に作られた部品からランダムに10個を抽出して寸法 $x_1, \cdots, x_{10}\ [\mathrm{cm}]$ を測定すると、結果が以下のようになった。

```
10.21, 9.98,  9.93,  10.25, 9.99,
10.08, 10.17, 10.43, 10.19, 10.11
```

部品 A の実際の寸法が正規分布に従うと仮定する時、有意水準を5%として、この部品の寸法の平均値は $10.00\ \mathrm{cm}$ であると言えるか？

### 帰無仮説・対立仮説の設定

- 帰無仮説 $H_0$：部品 A の寸法の平均値 $\mu = 10.00$
- 対立仮説 $H_1$：部品 A の寸法の平均値 $\mu \ne 10.00$

となる両側検定を行う。

### 検定統計量の選定

部品 A の寸法は正規分布に従うから、$n=10$ 個の標本から計算した標本平均を $\bar{x}$、不偏分散を $s^2$ として、

$$
t := \cfrac{\bar{x}-\mu}{\sqrt{s^2/n}}
$$

は自由度 $n-1=9$ の t 分布に従う。

検証したい $\mu$ 以外は既知の値なので、この $t$ を検定検定量として用いる。

### 棄却域の計算

有意水準 $\alpha = 0.05$ の両側検定であるから、この $t$ が t 分布の下側2.5%点 $t_{0.975}$ と上側2.5%点 $t_{0.025}$ との間にあれば、帰無仮説 $H_0$ は妥当と言える。  
自由度9の t 分布表より $t_{0.025} = 2.262,\ t_{0.975} = -t_{0.025} = -2.262$ と求まるので、帰無仮説 $H_0$ の棄却域は

$$
t \le -2.262,\ 2.262 \le t
$$

### 検定統計量の計算

$$
\bar{x} = \cfrac{1}{10} \sum_{i=1}^{10} x_i = 10.13
$$

$$
s^2 = \cfrac{1}{10-1} \sum_{i=1}^{10} (x_i - \bar{x})^2 = 0.0223
$$

であるから、帰無仮説 $\mu=10.00$ が正しいと仮定すると、

$$
t = \cfrac{10.13-10.00}{\sqrt{0.0223/10}} \simeq 2.75
$$

これは棄却域に含まれるので、帰無仮説 $H_0$ は棄却される。

### 結論

この工場で製造される部品 A の寸法の平均値が $10.00\ \mathrm{cm}$ であるとは言えない。


# 片側 t 検定

> **【問題設定】**
> 
> - 前提
> 	- 母集団が **正規分布** に従う
> - 調べたいこと
> 	- 注目する統計量がある値以上（または以下）であるか？

## 理論

ToDo

## 具体例

あるノート PC について、100% 充電時から無視用状態での内蔵バッテリーの持ち時間が120時間であると宣伝されている。

実際に製造されたこの製品12台を用いて実験すると、100% 充電時からバッテリーが来れるまでの時間 $x$ は以下のようになった。

```
113.3, 110.7, 121.7, 103.5,
138.9, 114.8, 119.5, 99.0,
119.1, 126.8, 118.7, 111.9
```

このノート PC のバッテリー持ち時間が正規分布に従うと仮定する時、有意水準5%として、「このノート PC のバッテリー持ち時間は120時間である」という宣伝文句は妥当と言えるか？

### 帰無仮説・対立仮説の設定

バッテリー持ち時間が120時間よりも長い場合は問題がないので、

- 帰無仮説 $H_0$：バッテリー持ち時間の平均値 $\mu = 120.0$（宣伝は妥当）
- 対立仮説 $H_1$：バッテリー持ち時間の平均値 $\mu \lt 120.0$（宣伝は誇大広告）

となる片側検定を行う。

### 検定統計量の選定

バッテリー持ち時間は正規分布に従うから、$n=12$ 個の標本から計算した標本平均を $\bar{x}$、不偏分散を $s^2$ として、

$$
t := \cfrac{\bar{x}-\mu}{\sqrt{s^2/n}}
$$

は自由度 $n-1=11$ の t 分布に従う。

検証したい $\mu$ 以外は既知の値なので、この $t$ を検定検定量として用いる。

### 棄却域の計算

有意水準 $\alpha = 0.05$ で $\mu$ の上限を対立仮説とする片側検定であるから、この $t$ が t 分布の下側5%点 $t_{0.95}$ 以上の範囲にあれば、帰無仮説 $H_0$ は妥当と言える。  

※ $t = (\bar{x}-\mu)/\sqrt{s^2/n}$ なので、$\mu$ の上限値について考える場合、$t$ に関しては下限値を考える必要がある。

自由度11の t 分布表より $t_{0.95} = -t_{0.05} = -1.796$ と求まるので、帰無仮説 $H_0$ の棄却域は

$$
t \le -1.796
$$

### 検定統計量の計算

$$
\bar{x} = \cfrac{1}{12} \sum_{i=1}^{12} x_i = 116.5
$$

$$
s^2 = \cfrac{1}{12-1} \sum_{i=1}^{12} (x_i - \bar{x})^2 = 109.0
$$

であるから、帰無仮説 $\mu=120.0$ が正しいと仮定すると、

$$
t = \cfrac{116.5-120.0}{\sqrt{109.0/12}} \simeq -1.16
$$

これは棄却域に含まれないので、帰無仮説 $H_0$ は棄却されない。

### 結論

「このノート PC のバッテリー持ち時間は120時間である」という宣伝文句は誇大広告とは言えない。


# 独立2群・等分散：Student の t 検定

> **【問題設定】**
> 
> - 前提
> 	- 2つの母集団が **正規分布** に従い、**互いに独立** している
> 	- 2つの母集団の **分散は等しい**
> - 調べたいこと
> 	- 2つの母集団の母平均に有意差があるか否か？

## 理論

以下の定理により、

- 母分散 $\sigma$ を式に含まない
- 母平均 $\mu_A, \mu_B$ の差を含む
- t 分布に従う

検定統計量 $t$ を得ることができる。  
これを用いて $t$ 検定を行う。

> **【定理】**
> 
> 2つの母集団 A, B が **正規分布** に従い、**互いに独立** しており、かつ A, B の **母分散が等しい** 時、
> 
> - $n_A, n_B$：母集団 A, B の標本数
> - $\mu_A, \mu_B$：母集団 A, B の母平均
> - $\sigma^2$：母集団 A, B の母分散
> - $\bar{x}_A, \bar{x}_B$：母集団 A, B の標本平均
> - $s_A^2, s_B^2$：母集団 A, B の標本不偏分散
> 
> とすると、以下で定義される統計量 $t$ は自由度 $n_A + n_B -2$ の $t$ 分布に従う。  
> 
> $$
t := \cfrac{(\bar{x}_A - \bar{x}_B) - (\mu_A-\mu_B)}{\sqrt{s^2 \left( \cfrac{1}{n_A}+\cfrac{1}{n_B} \right)}}
$$
> 
> $$
s^2 := \cfrac{s_A^2(n_A-1) + s_B^2(n_B-1)}{(n_A-1) + (n_B-1)}
$$

**【証明】**

仮定より、グループ A の標本 $x_{Ai}\ (i = 1, \cdots, n_A)$、グループ B の標本 $x_{Bi}\ (i = 1, \cdots, n_B)$ について

$$
\begin{eqnarray}
	x_{Ai} &\sim N(\mu_A, \sigma^2) \\
	x_{Bi} &\sim N(\mu_B, \sigma^2)
\end{eqnarray}
$$

が成り立つ。よって

$$
\begin{eqnarray}
	\bar{x}_A &\sim N(\mu_A, \sigma^2/n_A) \\
	\bar{x}_B &\sim N(\mu_B, \sigma^2/n_B)
\end{eqnarray}
$$


これらから $\mu_A, \mu_B$ を引いて $\sigma$ で割ると、

$$
\begin{eqnarray}
	\cfrac{\bar{x}_A-\mu_A}{\sigma} &\sim N(0, 1/n_A) \\
	\cfrac{\bar{x}_B-\mu_B}{\sigma} &\sim N(0, 1/n_B)
\end{eqnarray}
$$

これらの差を取ると、

$$
\cfrac{\bar{x}_A-\mu_A}{\sigma} - \cfrac{\bar{x}_B-\mu_B}{\sigma}
=
\cfrac{(\bar{x}_A-\bar{x}_B)-(\mu_A-\mu_B)}{\sigma}
\sim
N\left( 0, \cfrac{1}{n_A}+\cfrac{1}{n_B} \right)
$$

標準化して、

$$
\cfrac{
	(\bar{x}_A-\bar{x}_B)-(\mu_A-\mu_B)
}{
	\sigma \sqrt{\cfrac{1}{n_A}+\cfrac{1}{n_B}}
}
\sim
N(0, 1)
\qquad\qquad (1)
$$

次に、正規分布に従う確率変数の標本不偏分散とカイ二乗分布の関係（cf. [カイ二乗分布](../distribution/chi-square-distribution.md)）から、

$$
\begin{eqnarray}
	\cfrac{(n_A-1)s_A^2}{\sigma^2} &\sim \chi^2 (n_A-1) \\
	\cfrac{(n_B-1)s_B^2}{\sigma^2} &\sim \chi^2 (n_B-1)
\end{eqnarray}
$$

これらの和を取ると、カイ二乗分布の和の再生性から、

$$
\cfrac{(n_A-1)s_A^2}{\sigma^2} + \cfrac{(n_B-1)s_B^2}{\sigma^2}
\sim \chi^2 ((n_A-1)+(n_B-1))
$$

整理して、

$$
\cfrac{(n_A-1)s_A^2 + (n_B-1)s_B^2}{\sigma^2}
\sim \chi^2 (n_A+n_B-2)
\qquad\qquad (2)
$$

以上により、標準正規分布に従う変数 $(1)$ と自由度 $n_A+n_B-2$ のカイ二乗分布に従う変数 $(2)$ が得られた。  
$(1)/\sqrt{(2)/(n_A+n_B-2)}$ の計算により、自由度 $n_A+n_B-2$ の t 分布に従う変数 $t$ を得る：

$$
\begin{eqnarray}
	t &:=&
	\cfrac{
		(\bar{x}_A-\bar{x}_B)-(\mu_A-\mu_B)
	}{
		\sigma \sqrt{\cfrac{1}{n_A}+\cfrac{1}{n_B}}
		\sqrt{\cfrac{(n_A-1)s_A^2 + (n_B-1)s_B^2}{(n_A+n_B-2)\sigma^2}}
	}
	\\ &=&
	\cfrac{(\bar{x}_A - \bar{x}_B) - (\mu_A-\mu_B)}{\sqrt{s^2 \left( \cfrac{1}{n_A}+\cfrac{1}{n_B} \right)}}
	\sim t(n_A+n_B-2)
\end{eqnarray}
$$

ただし、

$$
s^2 := \cfrac{s_A^2(n_A-1) + s_B^2(n_B-1)}{(n_A-1) + (n_B-1)}
$$

## 具体例

全国的に実施された数学の学力試験に関して、その点数を A 県・B 県からランダムに10人分ずつ抽出すると、結果は以下の通りだった。

```
A県: 57, 44, 68, 34, 46, 42, 49, 57, 65, 78
B県: 49, 56, 48, 69, 65, 64, 81, 63, 60, 74
```

A 県・B 県の試験の点数はともに正規分布に従い、A 県と B 県では分散が等しいと仮定する。  
有意水準を5%として、A 県・B 県の今回の数学の試験結果に有意差があると言えるか？


### 帰無仮説・対立仮説の設定

- 帰無仮説 $H_0$：A 県・B 県の間で平均点に差はない
- 対立仮説 $H_1$：A 県・B 県の間で平均点に差がある

### 検定統計量の選定

- $n_A, n_B$：A 県・B 県の標本数
- $\bar{x}_A, \bar{x}_B$：A 県・B 県の点数の標本平均
- $s_A^2, s_B^2$：A 県・B 県の点数の標本不偏分散

とすると、$t$ 値

$$
t = \cfrac{(\bar{x}_A - \bar{x}_B) - (\mu_A-\mu_B)}{\sqrt{s^2 \left( \cfrac{1}{n_A}+\cfrac{1}{n_B} \right)}}
$$

$$
s^2 = \cfrac{s_A^2(n_A-1) + s_B^2(n_B-1)}{(n_A-1) + (n_B-1)}
$$

は自由度 $n_A + n_B -2 = 18$ の $t$ 分布に従う。  
これを検定量として用いる。

### 棄却域の計算

有意水準 $\alpha = 0.05$ なので、$t$ が t 分布の下側2.5%点 $t_{0.975}$ と上側2.5%点 $t_{0.025}$ との間にあれば、帰無仮説 $H_0$ は妥当と言える。  
自由度18の t 分布表より $t_{0.025} = 2.101,\ t_{0.975} = -t_{0.025} = -2.101$ と求まるので、帰無仮説 $H_0$ の棄却域は

$$
t \le -2.101,\ 2.101 \le t
$$

### 検定統計量の計算

$$
\begin{eqnarray}
	\bar{x}_A &=& \cfrac{1}{10} \sum_{i=1}^{10} x_{Ai} = 54.0
	\\
	\bar{x}_B &=& \cfrac{1}{10} \sum_{i=1}^{10} x_{Bi} = 62.9
	\\
	s_A^2 &=& \cfrac{1}{10-1} \sum_{i=1}^{10} (x_{Ai}-\bar{x}_A)^2 = 182.7
	\\
	s_B^2 &=& \cfrac{1}{10-1} \sum_{i=1}^{10} (x_{Bi}-\bar{x}_B)^2 = 107.2
	\\
	s^2 &=& \cfrac{182.7(10-1) + 107.2(10-1)}{(10-1) + (10-1)} = 145.0
\end{eqnarray}
$$

であるから、帰無仮説が正しい（$\mu_A = \mu_B$）とき、

$$
t = \cfrac{(54.0-62.9)-0}{\sqrt{145.0 \left( \cfrac{1}{10}+\cfrac{1}{10} \right)}} \simeq -1.65
$$

これは棄却域に含まれないので、帰無仮説 $H_0$ は棄却されない。

### 結論

A 県・B 県の間で点数に有意な差があるとは言えない。


# 独立2群・異分散：Welch の t 検定

> **【問題設定】**
> 
> - 前提
> 	- 2つの母集団が **正規分布** に従い、**互いに独立** している
> 	- 2つの母集団の **分散が等しいとは限らない**
> - 調べたいこと
> 	- 2つの母集団の母平均に有意差があるか否か？

## 理論

検定統計量

$$
t := \cfrac{(\bar{x}_A-\bar{x}_B) - (\mu_A - \mu_B)}{\sqrt{\cfrac{s_A^2}{n_A}+\cfrac{s_B^2}{n_B}}}
$$

が近似的に自由度

$$
\nu \approx \cfrac{
	\left( \cfrac{s_A^2}{n_A} + \cfrac{s_B^2}{n_B} \right)^2
}{
	\cfrac{(s_A^2/n_A)^2}{n_A-1} +
	\cfrac{(s_B^2/n_B)^2}{n_B-1}
}
$$

の t 分布に従うことを利用して、t 検定を行う。

（出典）B. L. Welch, The significance of the difference between two means when the population variances are unequal, _Biometrika_ 29, 350-362 (1938)

## 具体例

試験前1習慣の勉強時間の長さによりグループ分けしたグループ A（11人）とグループ B（8人）の数学の試験の点数は以下の通りだった。

```
A: 73, 94, 89, 92, 49, 28, 99, 75, 9, 79, 31
B: 33, 22, 43, 30, 33, 63, 46, 57, 25
```

グループ A・B の点数はそれぞれ正規分布に従うと仮定する。  
有意水準を5%として、グループ A・B の平均点に有意差があると言えるか？

### 帰無仮説・対立仮説の設定

- 帰無仮説 $H_0$：グループ A・B の間で平均点に差はない
- 対立仮説 $H_1$：グループ A・B の間で平均点に差がある

### 検定統計量の選定

- $n_A, n_B$：A・B の人数
- $\bar{x}_A, \bar{x}_B$：A・B の点数の標本平均
- $s_A^2, s_B^2$：A・B の点数の標本不偏分散

とすると、$t$ 値

$$
t = \cfrac{(\bar{x}_A-\bar{x}_B) - (\mu_A - \mu_B)}{\sqrt{\cfrac{s_A^2}{n_A}+\cfrac{s_B^2}{n_B}}}
$$

は自由度

$$
\nu \approx \cfrac{
	\left( \cfrac{s_A^2}{n_A} + \cfrac{s_B^2}{n_B} \right)^2
}{
	\cfrac{(s_A^2/n_A)^2}{n_A-1} +
	\cfrac{(s_B^2/n_B)^2}{n_B-1}
}
\simeq 14.57
\simeq 15
$$

の $t$ 分布に従う。

これを検定量として用いる。

### 棄却域の計算

有意水準 $\alpha = 0.05$ なので、$t$ が t 分布の下側2.5%点 $t_{0.975}$ と上側2.5%点 $t_{0.025}$ との間にあれば、帰無仮説 $H_0$ は妥当と言える。  
自由度15の t 分布表より $t_{0.025} = 2.131,\ t_{0.975} = -t_{0.025} = -2.131$ と求まるので、帰無仮説 $H_0$ の棄却域は

$$
t \le -2.131,\ 2.131 \le t
$$

### 検定統計量の計算

$$
\begin{eqnarray}
	\bar{x}_A &=& \cfrac{1}{10} \sum_{i=1}^{10} x_{Ai} = 65.3
	\\
	\bar{x}_B &=& \cfrac{1}{10} \sum_{i=1}^{10} x_{Bi} = 39.1
	\\
	s_A^2 &=& \cfrac{1}{10-1} \sum_{i=1}^{10} (x_{Ai}-\bar{x}_A)^2 = 957.8
	\\
	s_B^2 &=& \cfrac{1}{10-1} \sum_{i=1}^{10} (x_{Bi}-\bar{x}_B)^2 = 200.4
\end{eqnarray}
$$

であるから、帰無仮説が正しい（$\mu_A = \mu_B$）とき、

$$
t = \cfrac{(65.3-39.1)-0}{\sqrt{\cfrac{957.8}{11}+\cfrac{200.4}{9}}} \simeq 2.51
$$

これは棄却域に含まれるので、帰無仮説 $H_0$ は棄却され、対立仮説 $H_1$ が採択される。

### 結論

グループ A・B の間で平均点に有意な差があると言える。


# 関連2群

> **【問題設定】**
> 
> - 前提
> 	- 2つの母集団 A, B が **正規分布** に従う
> 	- A の標本と B の標本が1対1で対応している
> - 調べたいこと
> 	- 2つの母集団の母平均に有意差があるか否か？

## 理論

グループ A の標本 $x_{A1}, \cdots, x_{An}$ がそれぞれ、グループ B の標本 $x_{B1}, \cdots, x_{Bn}$ と対応している場合、$x_{A1}-x_{B1}, \cdots, x_{An}-x_{Bn}$ を確率変数 $Y := X_A-X_B$ の標本とみなせば、

- 帰無仮説 $H_0$：$Y$ の平均値が0
- 対立仮説 $H_1$：$Y$ の平均値が0でない

という1変数の t 検定に落とし込める。

## 具体例

ある学生5人の数学の試験の成績について、前期試験（A）と後期試験（B）で有意な差があったかどうかを調べたい。

この5人の前期試験・後期試験の成績は以下の通りであった。

```
Student ID:  1   2   3   4   5
         A: 63, 75, 72, 67, 71
         B: 82, 70, 78, 81, 79
```

A も B も、成績は正規分布に従うと仮定する。  
有意水準を5%として、前期試験と後期試験で、学生たちの成績に有意な差があったと言えるか？

### 帰無仮説・対立仮説の設定

- 帰無仮説 $H_0$：A, B の間で成績に変化はない（$Y$ の平均値がゼロ）
- 対立仮説 $H_1$：A, B の間で成績に変化がある（$Y$ の平均値がゼロでない）

### 検定統計量の選定

- $n$：学生の人数（標本数）
- $\bar{y}$：$Y$ の標本平均
- $s^2$：$Y$ の標本不偏分散
- $\mu$：$Y$ の母分散

とすると、$t$ 値

$$
t = \cfrac{\bar{y} - \mu}{\sqrt{s^2/n}}
$$

は自由度 $n-1 = 4$ の $t$ 分布に従う。  
これを検定量として用いる。

### 棄却域の計算

有意水準 $\alpha = 0.05$ の両側検定なので、$t$ が t 分布の下側2.5%点 $t_{0.975}$ と上側2.5%点 $t_{0.025}$ との間にあれば、帰無仮説 $H_0$ は妥当と言える。  
自由度4の t 分布表より $t_{0.025} = 2.776,\ t_{0.975} = -t_{0.025} = -2.776$ と求まるので、帰無仮説 $H_0$ の棄却域は

$$
t \le -2.776,\ 2.776 \le t
$$

### 検定統計量の計算

$$
\begin{eqnarray}
	\bar{y} &=& \cfrac{1}{5} \sum_{i=1}^{5} y_i = 8.4
	\\
	s^2 &=& \cfrac{1}{5-1} \sum_{i=1}^{5} (y_i-\bar{y})^2 = 82.3
\end{eqnarray}
$$

であるから、帰無仮説が正しい（$\mu = 0$）とき、

$$
t = \cfrac{8.4-0}{\sqrt{82.3/5}} \simeq -2.07
$$

これは棄却域に含まれないので、帰無仮説 $H_0$ は棄却されない。

### 結論

前期試験と後期試験の間で点数に有意な差があったとは言えない。
