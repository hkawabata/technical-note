---
title: 強連結成分（SCC）
---

# 強連結成分（SCC）とは

**強連結成分（SCC, Strongly Connected Component）** = 有向グラフにおいて、互いに行き来が可能な頂点の集合。

- SCC を求めることを **強連結成分分解** という
- 元の有向グラフが DAG でなくとも、そのグラフの **SCC は DAG を形成する**

![スライド11](https://user-images.githubusercontent.com/13412823/71308128-c7ae9800-243b-11ea-9677-0b1612fb716b.png)

# 強連結成分分解の方法

## 基本的な考え方

（TODO）

## 処理の流れ

1. 対象グラフ $$G$$ の探索：頂点ラベリング
	1. 適当に選んだ $$G$$ の未探索の頂点から深さ優先探索を行い、**帰りがけ** に頂点を番号ラベリングする
		- 番号は1つずつ増やしていく
	2. 未探索の頂点がなくなるまで繰り返す
		- 2回目以降の探索において、それ以前の探索で訪問済みの頂点は探索対象に含めない
2. $$G$$ の逆グラフ $$G^T$$ を作成
	- 1で $$G$$ に付与した番号ラベルを引き継ぐ
3. 逆グラフ $$G^T$$ の探索：SCC 分解
	1. 未探索のうち、**番号ラベルが一番大きい頂点** からグラフ探索
	2. **探索した頂点の集合 = 1つの SCC**
	3. 未探索の頂点がなくなるまで繰り返す

## 具体例

例題として、以下の有向グラフ $$G$$ における SCC を求める。

![スライド04](https://user-images.githubusercontent.com/13412823/71308120-c67d6b00-243b-11ea-94ec-2266ab813e9c.png)

適当に選んだ頂点から深さ優先（帰りがけ探索）し、1から番号を増やしながらラベリング：

![スライド05](https://user-images.githubusercontent.com/13412823/71308122-c7160180-243b-11ea-81ee-77888541fb23.png)

まだラベルのない頂点があるので、その中から適当に頂点を選び、そこから同様に深さ優先探索（帰りがけ探索）：

![スライド06](https://user-images.githubusercontent.com/13412823/71308123-c7160180-243b-11ea-95a4-d712842e7682.png)

$$G$$ のエッジをすべて逆向きにしたグラフ $$G^T$$ を用意：

![スライド07](https://user-images.githubusercontent.com/13412823/71308124-c7160180-243b-11ea-9f4e-bc3ce5dd4b3e.png)

頂点のうち、ラベル番号が最大のものを選んでグラフ探索 → **通った頂点はすべて1つの SCC に属する**：

![スライド08](https://user-images.githubusercontent.com/13412823/71308125-c7160180-243b-11ea-8c61-09e923b4a2d4.png)

未探索の頂点のうち、ラベル番号が最大のものを選んでグラフ探索 → **通った頂点はすべて1つの SCC に属する**：

![スライド09](https://user-images.githubusercontent.com/13412823/71308126-c7ae9800-243b-11ea-8d74-966ba536b86e.png)

未探索の頂点のうち、ラベル番号が最大のものを選んでグラフ探索 → **通った頂点はすべて1つの SCC に属する**：

![スライド10](https://user-images.githubusercontent.com/13412823/71308127-c7ae9800-243b-11ea-9e90-6f0dce01baea.png)

すべての頂点を探索し、SCC が全て求まった：

![スライド11](https://user-images.githubusercontent.com/13412823/71308128-c7ae9800-243b-11ea-9677-0b1612fb716b.png)
